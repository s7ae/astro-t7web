---
// 开场动画组件
---

<div class="intro-animation" id="intro-animation">
  <div class="intro-lines" id="intro-lines"></div>
  <h1 class="intro-text" id="intro-text">s7ae</h1>
</div>

<style>
  #intro-animation {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 50%, #0a0a1a 100%);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    overflow: hidden;
    box-shadow: inset 0 0 200px rgba(74, 74, 255, 0.3);
    transition: opacity 1s ease-in-out;
  }

  #intro-animation::before,
  #intro-animation::after {
    content: '';
    position: absolute;
    border-radius: 50%;
    filter: blur(100px);
    opacity: 0.3;
    animation: float 8s ease-in-out infinite;
  }

  #intro-animation::before {
    width: 300px;
    height: 300px;
    background: #4a4aff;
    top: 20%;
    left: 15%;
    animation-delay: 0s;
  }

  #intro-animation::after {
    width: 250px;
    height: 250px;
    background: #ff4a99;
    bottom: 20%;
    right: 15%;
    animation-delay: 2s;
  }

  @keyframes float {
    0%, 100% { transform: translate(0, 0); }
    50% { transform: translate(30px, 30px); }
  }

  #intro-text {
    font-size: 10rem;
    font-weight: 400;
    font-family: 'Monoton', cursive;
    color: transparent;
    background: linear-gradient(45deg, #00f5ff, #ff00ff, #00f5ff);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    background-clip: text;
    position: relative;
    animation: fadeInScale 0.8s ease forwards, gradientText 1s ease infinite;
    text-shadow: 0 0 15px rgba(0, 245, 255, 0.9),
                 0 0 30px rgba(0, 245, 255, 0.7),
                 0 0 50px rgba(0, 245, 255, 0.5),
                 0 0 100px rgba(255, 0, 255, 0.3);
    letter-spacing: 10px;
  }

  @keyframes fadeInScale {
    0% { opacity: 0; transform: scale(0.5); }
    70% { opacity: 1; transform: scale(1.1); }
    100% { opacity: 1; transform: scale(1); }
  }

  @keyframes gradientText {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  .intro-lines {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
  }

  .intro-line {
    position: absolute;
    background: linear-gradient(90deg, transparent, rgba(74, 74, 255, 0.7), transparent);
    height: 1px;
    width: 0%;
    transform-origin: left;
    box-shadow: 0 0 5px rgba(74, 74, 255, 0.8);
  }

  @keyframes drawHorizontal {
    0% { width: 0%; }
    100% { width: 100%; }
  }

  @keyframes drawVertical {
    0% { height: 0%; }
    100% { height: 100%; }
  }

  @keyframes fadeOut {
    0% { opacity: 1; }
    100% { opacity: 0; pointer-events: none; }
  }

  @keyframes fadeOutLines {
    0% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(1.05); }
    100% { opacity: 0; transform: scale(1); }
  }
</style>

<script is:inline>
  (function() {
    const introAnimation = document.getElementById('intro-animation');
    const introText = document.getElementById('intro-text');
    const linesContainer = document.getElementById('intro-lines');
    const canvas = document.getElementById('canvas-background');
    const container = document.querySelector('.container');

    // 检查是否应该跳过动画
    if (localStorage.getItem('skipIntroAnimation') === 'true') {
      introAnimation.style.opacity = '0';
      introAnimation.style.pointerEvents = 'none';
      if (canvas) {
        canvas.classList.add('fade-in');
        canvas.style.zIndex = '-1';
      }
      if (container) {
        container.classList.add('fade-in');
      }
      localStorage.removeItem('skipIntroAnimation');
      return;
    }

    // 创建线条动画
    const lineCount = 15;
    for (let i = 0; i < lineCount; i++) {
      const line = document.createElement('div');
      line.className = 'intro-line';
      const isHorizontal = Math.random() > 0.5;
      const delay = Math.random() * 0.5;
      if (isHorizontal) {
        line.style.top = Math.random() * 100 + '%';
        line.style.left = '0';
        line.style.height = '1px';
        line.style.transform = 'rotate(0deg)';
      } else {
        line.style.top = '0';
        line.style.left = Math.random() * 100 + '%';
        line.style.width = '1px';
        line.style.height = '0%';
        line.style.transform = 'rotate(90deg)';
      }
      line.style.animation = isHorizontal 
        ? `drawHorizontal 0.8s ease-in-out ${delay}s forwards`
        : `drawVertical 0.8s ease-in-out ${delay}s forwards`;
      linesContainer.appendChild(line);
    }

    // 动画序列
    setTimeout(function() {
      const lines = document.querySelectorAll('.intro-line');
      lines.forEach((line, index) => {
        setTimeout(() => {
          line.style.animation = 'fadeOutLines 0.8s ease forwards';
        }, index * 50);
      });

      if (introText) {
        introText.style.animation = 'fadeOutLines 1s ease forwards';
      }

      setTimeout(() => {
        if (canvas) {
          canvas.classList.add('fade-in');
        }
      }, 300);

      setTimeout(function() {
        if (introAnimation) {
          introAnimation.style.animation = 'fadeOut 0.3s ease forwards';
          setTimeout(function() {
            if (container) {
              container.classList.add('fade-in');
            }
            if (canvas) {
              canvas.style.zIndex = '-1';
            }
            // 隐藏开场动画元素
            introAnimation.style.display = 'none';
          }, 200);
        }
      }, 500);
    }, 1000);

    // 备用机制：5秒后强制移除开场动画
    setTimeout(function() {
      if (introAnimation && introAnimation.style.display !== 'none') {
        introAnimation.style.opacity = '0';
        introAnimation.style.pointerEvents = 'none';
        if (canvas) {
          canvas.classList.add('fade-in');
          canvas.style.zIndex = '-1';
        }
        if (container) {
          container.classList.add('fade-in');
        }
        setTimeout(function() {
          introAnimation.style.display = 'none';
        }, 500);
      }
    }, 5000);
  })();
</script>
